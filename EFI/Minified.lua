local a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H="MineOS EFI","Change label","key_down","component_added","filesystem","URL boot",component.proxy,component.list,computer.pullSignal,computer.uptime,table.insert,math.max,math.min,math.huge,math.floor,0x2D2D2D,0xE1E1E1,0x878787,0x878787,0xE1E1E1;local I,J,K=g(h("eeprom")()),g(h("gpu")()),h("internet")()local L,M,N,O,P,Q,R=J.set,J.setBackground,J.fill,I.setData,I.getData;u,v,w,x,y,z,A,B,C,D,E,F,G,H={{"/OS.lua"},{"/init.lua",function()computer.getBootAddress,computer.setBootAddress=P,O end}},function()local S=h("screen")()if S then J.bind(S,true)Q,R=J.getResolution()end end,function(T,U,V,W,X)M(X)N(T,U,V,W," ")end,function(T,U,Y,Z)J.setForeground(Y)L(T,U,Z)end,function(Z,_,a0)return{s=Z,c=_,b=a0}end,function(U,Y,Z)x(o(Q/2-#Z/2),U,Y,Z)end,function(U,a1)U=o(R/2-U/2)w(1,1,Q,R,q)z(U,p,a1)return U+2 end,function(a2,a3)local a4={}for a5 in a2:gmatch("[^\r\n]+")do a4[#a4+1]=a5:gsub("\t","  ")end;local a6={["no such component"]={0x00000001,"NO_SUCH_COMPONENT"},["not enough memory"]={0x00000002,"OUT_OF_MEMORY"}}local a7=false;for a8=1,#a4 do for a8,a9 in pairs(a6)do if string.find(a4[a8],a9[2])then a7=true;break end end;if a7 then break end end;if a7 then M(0x0004ff)local U=A(#a4,"An error has occurred")for a8=1,#a4 do z(U,0xffffff,a4[a8])U=U+1 end else local U=A(#a4,a)for a8=1,#a4 do z(U,r,a4[a8])U=U+1 end end;if a3 then while i()~=c do end end end,function(...)local aa,ab=load(...)if aa then aa,ab=xpcall(aa,debug.traceback)if aa then return end end;B(ab,1)end,function(ac)local ad;for a8=1,#u do ad=u[a8]if ac.exists(ad[1])then B("Booting from "..(ac.getLabel()or ac.address))if P()~=ac.address then O(ac.address)end;if ad[2]then ad[2]()end;local ae,af,ag,ah,ab=ac.open(ad[1],"rb"),""repeat ag=ac.read(ae,n)af=af..(ag or"")until not ag;ac.close(ae)C(af,"="..ad[1])return 1 end end end,function(ai)return y("Back",ai,1)end,function(a1,aj)local ak=1;while 1 do local U,T,Z,al=A(#aj+2,a1)for a8=1,#aj do Z="  "..aj[a8].s.."  "T=o(Q/2-#Z/2)if a8==ak then M(s)x(T,U,t,Z)M(q)else x(T,U,r,Z)end;U=U+1 end;al={i()}if al[1]==c then if al[4]==200 and ak>1 then ak=ak-1 elseif al[4]==208 and ak<#aj then ak=ak+1 elseif al[4]==28 then if aj[ak].c then aj[ak].c()end;if aj[ak].b then break end end elseif al[1]==d and al[3]=="screen"then v()end end end,function(a1,am)local U,Z,an,ao,ap,al=A(2,a1),"",1;while 1 do ao=am..Z;N(1,U,Q,1," ")z(U,r,ao..(an and"_"or""))al={i(0.5)}if al[1]==c then if al[4]==28 then return Z elseif al[4]==14 then Z=Z:sub(1,-2)else ap=unicode.char(al[3])if ap:match("^[%w%d%p%s]+")then Z=Z..ap end end;an=1 elseif al[1]=="clipboard"then Z=Z..al[3]elseif not al[1]then an=not an end end end,function(aq)local ar,af,aa,ab=g(K).request(aq),""if ar then B("Downloading script")while 1 do aa,ab=ar.read(n)if aa then af=af..aa else ar.close()if ab then B(ab,1)else C(af,"=url")end;break end end else B("Invalid URL",1)end end;v()B("Hold Alt to show boot options")local as,at=j()+1;while j()<as do at={i(as-j())}if at[1]==c and at[4]==56 then local au={y("Disk utility",function()local av,aw=function(Z,ax)return(#Z<ax and Z..string.rep(" ",ax-#Z)or Z:sub(1,ax)).."   "end,{E()}local function ay()for a8=2,#aw do table.remove(aw,1)end;for az in h(e)do local ac=g(az)local aA,aB=ac.getLabel()or"Unnamed",ac.isReadOnly()k(aw,1,y((az==P()and"> "or"  ")..av(aA,10)..av(ac.spaceTotal()>1048575 and"HDD"or ac.spaceTotal()>65535 and"FDD"or"SYS",3)..av(aB and"R  "or"R/W",3)..av(math.ceil(ac.spaceUsed()/ac.spaceTotal()*100).."%",4)..az:sub(1,8).."â€¦",function()local aC={y("Set as bootable",function()O(az)ay()end,1),E()}if not aB then k(aC,2,y(b,function()pcall(ac.setLabel,G(b,"New value: "))ay()end,1))k(aC,3,y("Erase",function()B("Erasing "..az)ac.remove("")ay()end,1))end;F(aA.." ("..az..")",aC)end))end end;ay()F("Select filesystem",aw)end),E()}if K then k(au,2,y("System recovery",function()H("https://tinyurl.com/29urhz7z")end))k(au,3,y(f,function()H(G(f,"Address: "))end))end;F(a,au)end end;local aD=g(P())if not(aD and D(aD))then local function aE()for az in h(e)do aD=g(az)if D(aD)then computer.shutdown()else aD=nil end end;if not aD then B("Not boot sources found")end end;aE()while 1 do if i()==d then aE()end end end
